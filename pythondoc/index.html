
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../dartdoc/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>CircuitPython Doc - Communicate Trinket M0 Doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#circuitpython-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Communicate Trinket M0 Doc" class="md-header__button md-logo" aria-label="Communicate Trinket M0 Doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Communicate Trinket M0 Doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              CircuitPython Doc
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Communicate Trinket M0 Doc" class="md-nav__button md-logo" aria-label="Communicate Trinket M0 Doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Communicate Trinket M0 Doc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    CircuitPython Doc
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    CircuitPython Doc
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-the-board" class="md-nav__link">
    <span class="md-ellipsis">
      About the board
    </span>
  </a>
  
    <nav class="md-nav" aria-label="About the board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link" class="md-nav__link">
    <span class="md-ellipsis">
      Link
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circuitpython-version" class="md-nav__link">
    <span class="md-ellipsis">
      CircuitPython Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-acknowledgement" class="md-nav__link">
    <span class="md-ellipsis">
      Code Acknowledgement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Python Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Set up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r557-fingerprint-sensor" class="md-nav__link">
    <span class="md-ellipsis">
      R557 fingerprint sensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#091-inch-oled-optional" class="md-nav__link">
    <span class="md-ellipsis">
      0.91 inch OLED (Optional)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Calling Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codepy-api" class="md-nav__link">
    <span class="md-ellipsis">
      code.py API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="code.py API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-1-enroll-fingerprint-in-slot-argument" class="md-nav__link">
    <span class="md-ellipsis">
      Command '1' - Enroll fingerprint in slot "Argument"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-2-identify-fingerprint" class="md-nav__link">
    <span class="md-ellipsis">
      Command '2' - Identify fingerprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-3-delete-fingerprint" class="md-nav__link">
    <span class="md-ellipsis">
      Command '3' - Delete fingerprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-4-download-template-to-computer" class="md-nav__link">
    <span class="md-ellipsis">
      Command '4' - Download template to computer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-5-upload-template-from-computer-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      Command '5' - Upload template from computer and verify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-6-clear-all-models-in-sensors-flash-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Command '6' - Clear all models in sensor's flash memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Error Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Status Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success-code-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Success Code Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-text-creating-bitmap-image-for-external-display" class="md-nav__link">
    <span class="md-ellipsis">
      Displaying Text &amp; Creating Bitmap Image (For external display)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Displaying Text & Creating Bitmap Image (For external display)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-bitmap-image-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Bitmap image (Linux)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-text-and-bitmap-image" class="md-nav__link">
    <span class="md-ellipsis">
      Displaying Text and Bitmap Image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dartdoc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dart Doc
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-the-board" class="md-nav__link">
    <span class="md-ellipsis">
      About the board
    </span>
  </a>
  
    <nav class="md-nav" aria-label="About the board">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link" class="md-nav__link">
    <span class="md-ellipsis">
      Link
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circuitpython-version" class="md-nav__link">
    <span class="md-ellipsis">
      CircuitPython Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardware-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-acknowledgement" class="md-nav__link">
    <span class="md-ellipsis">
      Code Acknowledgement
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-code" class="md-nav__link">
    <span class="md-ellipsis">
      Python Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    <span class="md-ellipsis">
      Set up
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Set up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r557-fingerprint-sensor" class="md-nav__link">
    <span class="md-ellipsis">
      R557 fingerprint sensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#091-inch-oled-optional" class="md-nav__link">
    <span class="md-ellipsis">
      0.91 inch OLED (Optional)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Calling Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codepy-api" class="md-nav__link">
    <span class="md-ellipsis">
      code.py API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="code.py API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#command-1-enroll-fingerprint-in-slot-argument" class="md-nav__link">
    <span class="md-ellipsis">
      Command '1' - Enroll fingerprint in slot "Argument"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-2-identify-fingerprint" class="md-nav__link">
    <span class="md-ellipsis">
      Command '2' - Identify fingerprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-3-delete-fingerprint" class="md-nav__link">
    <span class="md-ellipsis">
      Command '3' - Delete fingerprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-4-download-template-to-computer" class="md-nav__link">
    <span class="md-ellipsis">
      Command '4' - Download template to computer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-5-upload-template-from-computer-and-verify" class="md-nav__link">
    <span class="md-ellipsis">
      Command '5' - Upload template from computer and verify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-6-clear-all-models-in-sensors-flash-memory" class="md-nav__link">
    <span class="md-ellipsis">
      Command '6' - Clear all models in sensor's flash memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Error Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#status-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Status Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success-code-printing" class="md-nav__link">
    <span class="md-ellipsis">
      Success Code Printing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-text-creating-bitmap-image-for-external-display" class="md-nav__link">
    <span class="md-ellipsis">
      Displaying Text &amp; Creating Bitmap Image (For external display)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Displaying Text & Creating Bitmap Image (For external display)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-bitmap-image-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Bitmap image (Linux)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displaying-text-and-bitmap-image" class="md-nav__link">
    <span class="md-ellipsis">
      Displaying Text and Bitmap Image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><h1 id="circuitpython-documentation">CircuitPython Documentation</h1>
<h2 id="about-the-board">About the board</h2>
<h3 id="link">Link</h3>
<ul>
<li><a href="https://www.raspberrypi.com/products/raspberry-pi-pico/">Raspberry Pi Pico</a></li>
<li><a href="https://www.adafruit.com/product/3500">Trinket M0</a></li>
<li><a href="https://wiki.seeedstudio.com/XIAO-RP2040/">Seeed Studio XIAO RP2040</a> (currently use)</li>
</ul>
<h3 id="circuitpython-version">CircuitPython Version</h3>
<ul>
<li>All boards use CircuitPython 8.2.9.</li>
</ul>
<h3 id="hardware-setup">Hardware setup</h3>
<ul>
<li>
<p>Raspberry Pi Pico</p>
<ul>
<li>Pin 1 (TX) -&gt; R557 (RX)</li>
<li>Pin 2 (RX) -&gt; R557 (TX)</li>
<li>Pin 37 (3.3V) -&gt; R557 (3.3V)</li>
<li>Pin GND -&gt; R557 (GND)</li>
</ul>
</li>
</ul>
<figure>
    <img src="../assets/picopinout.png" width="800" height="800" alt="Pico pinout">
    <figcaption>Raspberry Pi Pico pinout. Source: <a href="https://www.raspberrypi.com/documentation/microcontrollers/raspberry-pi-pico.html">Raspberry Pi Pico Documentation</a> </figcaption>
</figure>

<ul>
<li>
<p>Trinket M0</p>
<ul>
<li>Pin D4 (TX) -&gt; R557 (RX)</li>
<li>Pin D3 (RX) -&gt; R557 (TX)</li>
<li>Pin 3V (3.3V) -&gt; R557 (3.3V)</li>
<li>Pin 38 (GND) -&gt; R557 (GND)</li>
</ul>
</li>
</ul>
<figure>
    <img src="../assets/m0pinout.png" width="800" height="800" alt="Trinket M0 pinout">
    <figcaption>Trinket M0 pinout. Source: <a href="https://learn.adafruit.com/adafruit-trinket-m0-circuitpython-arduino/pinouts">Learn Adafruit website</a> </figcaption>
</figure>

<ul>
<li>
<p>Seeed Studio XIAO RP2040</p>
<ul>
<li>Pin D6 (TX) -&gt; R557 (RX)</li>
<li>Pin D7 (RX) -&gt; R557 (TX)</li>
<li>Pin 3V3 (3.3V) -&gt; R557 (3.3V)</li>
<li>Pin GND -&gt; R557 (GND)</li>
<li>Pin D5 (SCL) -&gt; 0.91 inch OLED I2C (SCL) (Optional)</li>
<li>Pin D4 (SDA) -&gt; 0.91 inch OLED I2C (SDA) (Optional)</li>
<li>Pin 5V -&gt; 0.91 inch OLED I2C (VCC) (Optional)</li>
<li>Pin GND -&gt; 0.91 inch OLED I2C (GND) (Optional)</li>
</ul>
</li>
</ul>
<p>Note: The display is completely optional and the code would still work fine if there is no display.</p>
<figure>
    <img src="../assets/xiao_pinout.png" width="800" height="800" alt="xiao rp2040 pinout">
    <figcaption>Seeed Studio XIAO RP2040 pinout. Source: <a href="https://wiki.seeedstudio.com/XIAO-RP2040/">Seeed Studio wiki</a> </figcaption>
</figure>

<figure>
    <img src="../assets/oled_display.png" width="500" height="500" alt="oled display">
    <figcaption>0.91 inch I2C OLED display. Source: <a href="https://aliexpress.com/item/1005006365875553.html">Aliexpress page</a> </figcaption>
</figure>

<h2 id="code-acknowledgement">Code Acknowledgement</h2>
<p><code>code.py</code> and <code>custom_finger_lib.py</code> are referenced from Adafruit CircuitPython Fingerprint github page (<a href="https://github.com/adafruit/Adafruit_CircuitPython_Fingerprint/tree/main">Python</a> and <a href="https://github.com/adafruit/Adafruit-Fingerprint-Sensor-Library/tree/master">C++</a>), more specifically <code>examples/fingerprint_r503.py</code> and <code>examples/fingerprint_template_file_compare.py</code>.</p>
<p><code>adafruit_fingerprint_reduced.py</code> is a copy from <code>adafruit_fingerprint.py</code> with unused functions removed. <code>adafruit_fingerprint.cpp</code> was also useful for listing all the possible error codes the sensor can return when using the functions in the library.</p>
<p>The display uses <code>adafruit_displayio_ssd1306.py</code> driver.</p>
<p>Credit to the authors of these library codes.</p>
<h2 id="python-code">Python Code</h2>
<h3 id="set-up">Set up</h3>
<h4 id="r557-fingerprint-sensor">R557 fingerprint sensor</h4>
<ol>
<li>Initialize UART object with TX, RX pins and baudrate=115200<strong>*</strong></li>
<li>
<p>Connect to sensor using UART object</p>
<ul>
<li>If it is unsucessful, it will try baudrate 9600*N with N from 1 to 12.</li>
<li>If it is successful, it will set the desired security level and data package size</li>
</ul>
</li>
<li>
<p>Create finger object from <code>adafruit_fingerprint_reduced.py</code></p>
</li>
<li>
<p>If the code cannot establish connection with the sensor even after trying different baudrate then the code will simply end later.</p>
<p>```
    Code done running.</p>
<pre><code>Press any key to enter the REPL. Use CTRL-D to reload.
</code></pre>
<p>```</p>
</li>
<li>
<p>Go to display set up</p>
</li>
</ol>
<p>*<em>Each board has a different name for TX and RX pins. We can check the pin names by going into REPL and do</em></p>
<pre><code>    &gt;&gt;&gt;import board
    &gt;&gt;&gt;dir(board)
</code></pre>
<h4 id="091-inch-oled-optional">0.91 inch OLED (Optional)</h4>
<ol>
<li>Create I2C object using board.I2C()<strong>*</strong></li>
<li>Initialize display bus and display SSD1306 displayio driver<ul>
<li>If no display is available, print error and set splash to None</li>
</ul>
</li>
<li>Create displayio Group called splash and set it as root group</li>
<li>Display white background</li>
<li>Display company name and logo for 1s</li>
<li>Go to main loop</li>
</ol>
<p>*<em>Some board might not support this function. An alternative is busio.I2C() which does the same thing but requires SDA and SCL pin. Refer to the section above and the datasheet to check the I2C pin name. This section might throw an error if there is no pull up resistor for the board.</em></p>
<p><em>Note: For a better guide on using the display in circuitpython, use this <a href="https://learn.adafruit.com/adafruit-oled-featherwing/python-usage">link</a> from adafruit</em></p>
<h3 id="calling-functions">Calling Functions</h3>
<p>Dart code can call functions by sending</p>
<pre><code>"[Command]" + " "(Optional) + "[Argument]"(Optional) + "\n" + "\r"
</code></pre>
<p>when prompted with "&gt;" from the Python code. The code python receive this by calling input() with usb_cdc imported.</p>
<p>"\n" signals that this is the end of the user input for input(). "\r" signals this is the end of the data so input() can start reading from the serial port.</p>
<p><strong>Important</strong>: usb_cdc allows the python code to treat the usb connection as a console/terminal, so print() and input() will automatically work on the serial port without the need for any specialise serial read/write functions.</p>
<p><strong>Format</strong>: &gt;[Command] [Argument]   (Only when dart code is used as a command line interface)</p>
<p><strong>Type</strong>:</p>
<ul>
<li>Command: <em>String</em> from '1' to '6'</li>
<li>Argument (optional): <em>String</em> from '1' to '120'</li>
</ul>
<h3 id="codepy-api">code.py API</h3>
<h4 id="command-1-enroll-fingerprint-in-slot-argument">Command '1' - Enroll fingerprint in slot "Argument"</h4>
<p>Input: &gt;1 [slot number] or send "1 [slot number]\n\r" through serial</p>
<p>Output:</p>
<pre><code>&gt;1 1              #Enroll finger (command 1) in slot 1
1 1
FINGERREQUEST     #Request User to press finger on sensor
FINGERHOLD        #Request User to hold finger on sensor
OKIMAGE           #Image taken successfully
TEMPLATING        #Converting image to template
OKTEMPLATE        #Image converted to template successfully
REMOVEFINGER      #Request User to remove finger off sensor
FINGERREQUEST     #Request User to press finger on sensor
FINGERHOLD        #Request User to hold finger on sensor
OKIMAGE           #Image taken successfully
TEMPLATING        #Converting image to template
OKTEMPLATE        #Image converted to template successfully
CREATEMODEL       #Create Model from template for storage
OKMODEL           #Create Model successfully
STOREMODEL        #Storing model on sensor flash memory
OKSTORAGE         #Model stored successfully
READTEMPLATE 1 2  #Display all models stored on sensor by listing its slot. Currently in slot 1 and slot 2.
&gt;                 #Command/Input request
</code></pre>
<p>Possible Errors:</p>
<ul>
<li>1 (PACKETRIEVEERR)</li>
<li>2 (NOFINGER)</li>
<li>3 (IMAGEFAIL)</li>
<li>6 (IMAGEMESS)</li>
<li>7 (FEATUREFAIL)</li>
<li>10 (ENROLLMISMATCH)</li>
<li>11 (BADLOCATION)</li>
<li>21 (INVALIDIMAGE)</li>
<li>24 (FLASHERR)</li>
<li>87 (NUMARGUMENT)</li>
<li>88 (LOCATIONVAL)</li>
<li>89 (WRONGCOMMAND)</li>
<li>CANCEL</li>
</ul>
<h4 id="command-2-identify-fingerprint">Command '2' - Identify fingerprint</h4>
<p>Input: &gt;2 or send "2\n\r" through serial</p>
<p>Output:</p>
<pre><code>READTEMPLATE 1 2
&gt;2                #Identify finger
FINGERREQUEST     #Request User to press finger on sensor
FINGERHOLD        #Request User to hold finger on sensor
OKIMAGE           #Image taken successfully
TEMPLATING        #Converting image to template
OKTEMPLATE        #Image converted to template successfully
SEARCHING         #Searching for Model that match template in sensor's flash memory
OKSEARCH 1 100    #Model found in slot 1 with confidence 100
READTEMPLATE 1 2
&gt;
</code></pre>
<p>Possible Errors:</p>
<ul>
<li>1 (PACKETRIEVEERR)</li>
<li>2 (NOFINGER)</li>
<li>3 (IMAGEFAIL)</li>
<li>6 (IMAGEMESS)</li>
<li>7 (FEATUREFAIL)</li>
<li>9 (NOTFOUND)</li>
<li>21 (INVALIDIMAGE)</li>
<li>89 (WRONGCOMMAND)</li>
<li>CANCEL</li>
</ul>
<h4 id="command-3-delete-fingerprint">Command '3' - Delete fingerprint</h4>
<p>Input: &gt;3 [slot number] or send "3 [slot number]\n\r" through serial</p>
<p>Output:</p>
<pre><code>READTEMPLATE 1 2
&gt;3 1              #Delete model in slot 1
OKDELETE          #Model deleted successfully
READTEMPLATE 2
&gt;
</code></pre>
<p>Possible Errors:</p>
<ul>
<li>1 (PACKETRIEVEERR)</li>
<li>11 (BADLOCATION)</li>
<li>24 (FLASHERR)</li>
<li>87 (NUMARGUMENT)</li>
<li>88 (LOCATIONVAL)</li>
<li>89 (WRONGCOMMAND)</li>
</ul>
<h4 id="command-4-download-template-to-computer">Command '4' - Download template to computer</h4>
<p>Input: &gt;4 or send "4\n\r" through serial</p>
<p>Output:</p>
<pre><code>&gt;4
4                  #Download template into Dart code
FINGERREQUEST      #Same steps as enroll. Default to slot 1.
FINGERHOLD
OKIMAGE
TEMPLATING
OKTEMPLATE
REMOVEFINGER
FINGERREQUEST
FINGERHOLD
OKIMAGE
TEMPLATING
OKTEMPLATE
CREATEMODEL
OKMODEL
STOREMODEL
OKSTORAGE
TEMPDOWNLOAD       #Start downloading template of enrolled fingerprint
OKDOWNLOAD 2048    #Template downloaded successfully sensor. Length: 2048 bytes
b'46704c...ffff1f29d8ff40'  #Hex data printed to serial port as String
READTEMPLATE 1 2
&gt;
</code></pre>
<p>Possible Error:</p>
<ul>
<li>Same as Command 1 as it uses command 1 first</li>
<li>90 (DOWNLOADFAIL)</li>
<li>CANCEL</li>
</ul>
<p>Note: In the current version of the Dart code, the template is stored in a variable called templateBuffer with Uint8List type which has a size of 4096 (Double the size of the template as the hex code is represented in String format)</p>
<h4 id="command-5-upload-template-from-computer-and-verify">Command '5' - Upload template from computer and verify</h4>
<p>Input: &gt;5 or send "5\n\r" through serial</p>
<p>Output:</p>
<pre><code>&gt;5                #Upload template to sensor to verify
5
46704c...ffff1f29d8ff40 #Data sent by the computer from Dart's templateBuffer
FINGERREQUEST     #Request User to press finger on sensor
FINGERHOLD        #Request User to hold finger on sensor
OKIMAGE           #Image taken successfully
TEMPLATING        #Converting image to template
OKTEMPLATE        #Image converted to template successfully
OKMATCH           #Template match with uploaded template
READTEMPLATE 1 2
&gt;
</code></pre>
<p>Possible Errors:</p>
<ul>
<li>1 (PACKETRIEVEERR)</li>
<li>2 (NOFINGER)</li>
<li>3 (IMAGEFAIL)</li>
<li>6 (IMAGEMESS)</li>
<li>7 (FEATUREFAIL)</li>
<li>21 (INVALIDIMAGE)</li>
<li>89 (WRONGCOMMAND)</li>
<li>91 (UPLOADFAIL)</li>
<li>92 (MATCHFAIL)</li>
<li>CANCEL</li>
</ul>
<h4 id="command-6-clear-all-models-in-sensors-flash-memory">Command '6' - Clear all models in sensor's flash memory</h4>
<p>Input: &gt;6 or send "6\n\r" through serial</p>
<p>Output:</p>
<pre><code>READTEMPLATE 1 2
&gt;6                  #Delete all models in sensor
6
OKDELETE            #Deleted successfully
READTEMPLATE 0      #No template in sensor
&gt;
</code></pre>
<p>Note: 0 does not mean there exist a model in slot 0. Slot 0 does not exist and is not a valid slot.</p>
<p>Possible Errors:</p>
<ul>
<li>1 (PACKETRIEVEERR)</li>
<li>11 (BADLOCATION)</li>
<li>24 (FLASHERR)</li>
<li>89 (WRONGCOMMAND)</li>
</ul>
<h3 id="error-printing">Error Printing</h3>
<p><strong>Format</strong>: ERROR [error number]</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Hex Code (Decimal)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>PACKETRIEVEERR</td>
<td>0x01 (1)</td>
<td>Trouble communicating with sensor</td>
</tr>
<tr>
<td>NOFINGER</td>
<td>0x02 (2)</td>
<td>Finger is not pressed on sensor when taking image</td>
</tr>
<tr>
<td>IMAGEFAIL</td>
<td>0x03 (3)</td>
<td>Imaging error</td>
</tr>
<tr>
<td>IMAGEMESS</td>
<td>0x06 (6)</td>
<td>Image is too messy. Cannot extract features</td>
</tr>
<tr>
<td>FEATUREFAIL</td>
<td>0x07 (7)</td>
<td>Failed to identify fingerprint feature</td>
</tr>
<tr>
<td>NOTFOUND</td>
<td>0x09 (9)</td>
<td>Fingerprint model not in sensor's library</td>
</tr>
<tr>
<td>ENROLLMISMATCH</td>
<td>0x0A (10)</td>
<td>Fingerprint is not the same when taken twice. Cannot generate model</td>
</tr>
<tr>
<td>BADLOCATION</td>
<td>0x0B (11)</td>
<td>Invalid location for operation</td>
</tr>
<tr>
<td>INVALIDIMAGE</td>
<td>0x15 (21)</td>
<td>Image taken is not a fingerprint. Failed to extract features</td>
</tr>
<tr>
<td>FLASHERR</td>
<td>0x18 (24)</td>
<td>Model could not be written to flash memory</td>
</tr>
<tr>
<td>SETPARAMFAIL</td>
<td>0x56 (86)</td>
<td>Cannot change sensor's parameter settings: baud rate, security level, data package size</td>
</tr>
<tr>
<td>NUMARGUMENT</td>
<td>0x57 (87)</td>
<td>Wrong number of arguments</td>
</tr>
<tr>
<td>LOCATIONVAL</td>
<td>0x58 (88)</td>
<td>Location/slot number argument is invalid. Range: 1-120</td>
</tr>
<tr>
<td>WRONGCOMMAND</td>
<td>0x59 (89)</td>
<td>Command does not exist</td>
</tr>
<tr>
<td>DOWNLOADFAIL</td>
<td>0x5A (90)</td>
<td>Cannot download model from sensor</td>
</tr>
<tr>
<td>UPLOADFAIL</td>
<td>0x5B (91)</td>
<td>Fail to upload template to sensor</td>
</tr>
<tr>
<td>MATCHFAIL</td>
<td>0x5C (92)</td>
<td>Fingerprint does not match with uploaded template</td>
</tr>
<tr>
<td>BADUPLOAD</td>
<td>0x5D (93)</td>
<td>Template uploaded from dart has incorrect length</td>
</tr>
<tr>
<td>NONHEX</td>
<td>0x5E (94)</td>
<td>Uploaded template from dart contains non hexidecimal character</td>
</tr>
</tbody>
</table>
<h3 id="status-printing">Status Printing</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>FINGERREQUEST</td>
<td>Request finger to be placed on sensor</td>
</tr>
<tr>
<td>FINGERHOLD</td>
<td>Request finger to be held on sensor</td>
</tr>
<tr>
<td>TEMPLATING</td>
<td>Converting image to template</td>
</tr>
<tr>
<td>SEARCHING</td>
<td>Searching for matching model in sensor's library/flash</td>
</tr>
<tr>
<td>REMOVEFINGER</td>
<td>Request finger to be removed off the sensor</td>
</tr>
<tr>
<td>CREATEMODEL</td>
<td>Creating model from template to be stored</td>
</tr>
<tr>
<td>STOREMODEL</td>
<td>Storing model in sensor's library</td>
</tr>
<tr>
<td>READTEMPLATE</td>
<td>Reading all the model/template stored in the sensor</td>
</tr>
<tr>
<td>PARAMDETAIL</td>
<td>Printing current configuration for sensor (baud rate, security level, data package size)</td>
</tr>
<tr>
<td>SENSORINIT</td>
<td>Establishing connection with sensor and setting sensor's configuration</td>
</tr>
<tr>
<td>TEMPDOWNLOAD</td>
<td>Downloading template from sensor</td>
</tr>
<tr>
<td>TEMPUPLOAD</td>
<td>Uploading template from sensor</td>
</tr>
<tr>
<td>DISPLAYINIT</td>
<td>Connecting with display using I2C.</td>
</tr>
</tbody>
</table>
<h3 id="success-code-printing">Success Code Printing</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OKIMAGE</td>
<td>Image taken successfully</td>
</tr>
<tr>
<td>OKTEMPLATE</td>
<td>Image converted to template successfully</td>
</tr>
<tr>
<td>OKMODEL</td>
<td>Create model is successful</td>
</tr>
<tr>
<td>OKSTORAGE</td>
<td>Model stored successfully in sensor's library</td>
</tr>
<tr>
<td>OKDELETE</td>
<td>Model deleted successfully</td>
</tr>
<tr>
<td>OKSEARCH</td>
<td>Template is identified. Location and confidence level is printed in that order</td>
</tr>
<tr>
<td>OKPARAMSET</td>
<td>Parameter set successfully for sensor</td>
</tr>
<tr>
<td>OKDOWNLOAD</td>
<td>Download template from sensor successfully. Number of byte is also printed</td>
</tr>
<tr>
<td>OKMATCH</td>
<td>Uploaded template matches with fingerprint.</td>
</tr>
<tr>
<td>OKUPLOAD</td>
<td>Template uploaded to sensor successfully</td>
</tr>
</tbody>
</table>
<h3 id="displaying-text-creating-bitmap-image-for-external-display">Displaying Text &amp; Creating Bitmap Image (For external display)</h3>
<p>As it might be necessary to change the text or image being displayed, this section is created as a guide. Reference: <a href="https://learn.adafruit.com/circuitpython-display_text-library/overview">text</a>, <a href="https://learn.adafruit.com/creating-your-first-tilemap-game-with-circuitpython/indexed-bmp-graphics">bitmap image</a></p>
<h4 id="creating-bitmap-image-linux">Creating Bitmap image (Linux)</h4>
<ol>
<li>Download GIMP</li>
<li>Download image that needs to be converted to bitmap</li>
<li>Open image in GIMP (top left corner: File -&gt; Open)</li>
<li>Crop the image to the desired size (Shift + C). Keep as little margin as possible as we are going to resize the image down smaller.</li>
<li>
<p>Use the bucket fill tool (Shift + B) to fill any transparent area with white. We will treat white as the 'transparent' color.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Image with transparent area</th>
<th style="text-align: center;">Image with no transparent area</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img alt="" src="../assets/transparent_normal.png"></td>
<td style="text-align: center;"><img alt="" src="../assets/transparent_good.png"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Since our display is black and white, use the bucket tool again to fill the image with black. The color on step 5 and 6 can be swapped if you want to display the image as white instead.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Black and white image</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img src="../assets/black_and_white_image.png" width="150" height="150"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Go to the top bar: Image -&gt; Mode -&gt; Indexed. Click on 'Use black and white (1-bit) palette' and 'Convert'. This convert the image to black and white but the color mapping can be quite random hence we did step 5 and 6 to ensure there is no need for mapping.</p>
</li>
<li>Resize the image to fit your display. Top bar: Image -&gt; Scale Image. Select the width and height to match your display. In our case, our display is 128 x 32 hence we will resize it to 32 x 32.<ul>
<li>The width and height box might automatically change to match the current's image width:height ratio. You can further crop the image to get the ratio you want. Same for the X, Y resolution</li>
</ul>
</li>
<li>
<p>For the X, Y resolution, use the display specification and do pixel/length or pixel/width and enter it in the box. Use the higher resolution for the image. In our case, it is 128 pixel/ 25 mm = 5.12 pixels/mm.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Scaled image</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img src="../assets/scaled_image.png" width="150" height="150"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>For the quality, refer to this <a href="https://docs.gimp.org/en/gimp-tools-transform.html#gimp-tool-interpolation-methods">documentation</a>. In our case, either Cubic or NoHalo works fine.</p>
</li>
<li>
<p>Use Paintbrush tool (P) and select the pixel size (1x1 pixel) on the right window to do any final adjustment.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Final image</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><img src="../assets/final_image.png" width="150" height="150"></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Go to the top bar: Colors -&gt; Map -&gt; Rearrange Colormap. Drag the color white to the first position. Don't worry about the number as it will change when we click OK. The first position will be considered as the 'transparent' color in displayio.</p>
</li>
<li>Finally, go to the top bar: File -&gt; Export As. And change the file extension to .bmp. Ex: image_name.png -&gt; image_name.bmp</li>
</ol>
<p><em>Note: You can change step 5, 6 and 7 to match your display color specification.</em></p>
<h4 id="displaying-text-and-bitmap-image">Displaying Text and Bitmap Image</h4>
<p>We made three functions to easily display text and image in custom_finger_lib.py. They only differ by the way they display text.</p>
<p>There is a assumption that the image is 32 x 32 (max) and the font is termialio.Font with scale = 2. Our layout is image on the left and text next to the image on the right. Of course, this can be changed in the library to fit your display. Examples are shown in the <a href="https://superstupidness.github.io/trinket_m0_communicate/#video">Introduction page</a></p>
<ol>
<li>
<p><code>def display_text_and_logo(splash, text, logo_file)</code></p>
<p>Input:</p>
<ul>
<li>splash: Displayio root group. displayio.Group() type</li>
<li>text: A string that you want to display</li>
<li>logo_file: file location of bitmap image. Ex: "\image.bmp". Can be None for not displaying image</li>
</ul>
<p>Output:</p>
<ul>
<li>text_area: ScrollingLabel object that can be used to scroll the text if it exceeds the display length</li>
</ul>
<p>Note: This will display text and logo indefinitely until another display function is called. If logo_file is None, the previous image won't be removed. Text can be scrolled using</p>
<pre><code>```
while True:

    text_area.update()

```
</code></pre>
</li>
<li>
<p><code>def display_sequence_of_text(splash, text, logo_file, duration)</code></p>
<p>Input:</p>
<ul>
<li>splash: Displayio root group</li>
<li>text: Multiple strings seperated by a space. Ex: "Hello World!"</li>
<li>logo_file: file location of bitmap image. Can be None for not displaying image</li>
<li>duration: duration to display all strings</li>
</ul>
<p>Output: None</p>
<p>Note: This will separate each string and display them with equal time slice. Ex: Hello -&gt; World!. The text and logo will be removed after the duration.</p>
</li>
<li>
<p><code>def display_scroll_sequence_of_text(splash, text, logo_file, duration, speed)</code></p>
<p>Input:</p>
<ul>
<li>splash: Displayio root group</li>
<li>text: Usually a long string</li>
<li>logo_file: file location of bitmap image. Can be None for not displaying image</li>
<li>duration: duration to scroll the string. Can be 0 to scroll indefinitely</li>
<li>speed: How fast the string is scrolled</li>
</ul>
<p>Output:</p>
<ul>
<li>text_area: ScrollingLabel object that can be used to scroll the text</li>
</ul>
<p>Note: This is used when the sensor is requesting fingerprint. The function is called and the output is put in a while loop to constantly display the message.</p>
<pre><code>```
while True:
    if text_area is not None:    # Check to see if there is a display
        text_area.update()

```
</code></pre>
</li>
</ol></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>